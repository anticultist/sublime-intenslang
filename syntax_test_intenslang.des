// SYNTAX TEST "intenslang.sublime-syntax"

// foo
// <- source.intens comment.line.intens

DATAPOOL

INTEGER one, two;
//  <- storage.type.intens
//      ^^^ punctuation.definition.variable.intens
//         ^ punctuation.separator.intens
//           ^^^ punctuation.definition.variable.intens
//              ^ punctuation.terminator.intens

COLOR mycolor1 ();
//  <- storage.type.intens
//    ^^^^^^^^ punctuation.definition.variable.intens
//             ^ punctuation.section.group.begin.intens
//              ^ punctuation.section.group.end.intens
//               ^ punctuation.terminator.intens


COLOR mycolor2 (
//  <- storage.type.intens
//    ^^^^^^^^ punctuation.definition.variable.intens
//             ^ punctuation.section.group.begin.intens
        INVALID = (red, black),
//      ^^^^^^^ variable.parameter.intens
//                            ^ punctuation.separator.intens
        < 0 = ("#fff", "#f00"),
//              ^^^^ constant.other.color.rgb-value.intens
//                            ^ punctuation.separator.intens
        RANGE(0, <2.1) = ("#ffffff", "#00ff00"),
//      ^^^^^ support.function.builtin.intens
//            ^ constant.numeric.intens
//                ^^^ constant.numeric.intens
//                                             ^ punctuation.separator.intens
        2 = ("#ffffff", "#0000ff"),
//                                ^ punctuation.separator.intens
        "mytext" = ( "#e0e0e0", "#e0e0e0" ),
//                                         ^ punctuation.separator.intens
        ELSE = ("#ffffff", "#0000ff")
//      ^^^^ variable.parameter.intens
    );
//  ^ punctuation.section.group.end.intens
//   ^ punctuation.terminator.intens

INTEGER baz {TOGGLE};
//  <- storage.type.intens
//      ^^^ punctuation.definition.variable.intens

INTEGER {EDITABLE}
//  <- storage.type.intens
//       ^^^^^^^^ storage.modifier.intens
    foo {LABEL="mylabel", TOGGLE, FUNC=myfunc},
//  ^^^ punctuation.definition.variable.intens
//                      ^ punctuation.separator.intens
//                              ^ punctuation.separator.intens
//                                     ^^^^^^ variable.function.intens
//                                            ^ punctuation.separator.intens
    bar {COLOR=mycolor2};
//  ^^^ punctuation.definition.variable.intens
//                      ^ punctuation.terminator.intens

SET myset ("zero"=0, "one"=1);
// <- storage.type.enum.intens
//  ^^^^^ entity.name.enum.intens
//        ^ punctuation.section.group.begin.intens
//                          ^ punctuation.section.group.end.intens
//                           ^ punctuation.terminator.intens

SET myset2 {INVALID=NONE} ("X"=0, "Y"=1);
//         ^ punctuation.section.group.begin.intens
//                 ^ keyword.operator.assignment.augmented.intens
//                  ^^^^ constant.language.intens
//                      ^ punctuation.section.group.end.intens

SET myset3 ("A"=1, "B"=2), myset4 ("C"=3, "D"=4);
//                         ^^^^^^ entity.name.enum.intens

SET STRING ();
// <- storage.type.enum.intens
//  ^^^^^^ invalid.illegal.name.intens
//         ^ punctuation.section.group.begin.intens
//          ^ punctuation.section.group.end.intens
//           ^ punctuation.terminator.intens

STRUCT MYSTRUCT {
// <- storage.type.struct.intens
//     ^^^^^^^^ entity.name.struct.intens
//              ^ punctuation.section.block.begin.intens
    INTEGER one, two;
//  ^^^^^^^ storage.type.intens
//          ^^^ punctuation.definition.variable.intens
//             ^ punctuation.separator.intens
//               ^^^ punctuation.definition.variable.intens
//                  ^ punctuation.terminator.intens
    REAL three;};
//  ^^^^ storage.type.intens
//       ^^^^^ punctuation.definition.variable.intens
//            ^ punctuation.terminator.intens
//             ^ punctuation.section.block.end.intens
//              ^ punctuation.terminator.intens

STRUCT MYSTRUCT_EXT : MYSTRUCT {
//                    ^^^^^^^^ entity.other.inherited-class.intens
    INTEGER four;
};

STRUCT MYSTRUCT2 {
    INTEGER{ EDITABLE }
//  ^^^^^^^ storage.type.intens
        button1 {LABEL="mylabel", BUTTON, FUNC=myfunc},
        foo {SET=myset};
//               ^^^^^ storage.type.enum.intens

    MYSTRUCT bar;
};

MYSTRUCT2 { OMIT_TTRAIL } foo;

STRUCT REAL {};
// <- storage.type.struct.intens
//     ^^^^ invalid.illegal.name.intens
//          ^ punctuation.section.block.begin.intens
//           ^ punctuation.section.block.end.intens
//            ^ punctuation.terminator.intens

STRUCT MYSTRUCT3 { INTEGER REAL;};
//               ^ punctuation.section.block.begin.intens
//                 ^^^^^^^ storage.type.intens
//                         ^^^^ invalid.illegal.name.intens
//                             ^ punctuation.terminator.intens
//                              ^ punctuation.section.block.end.intens
//                               ^ punctuation.terminator.intens

END DATAPOOL;
//          ^ punctuation.terminator.intens

FUNCTIONS

FUNC myfunc, myfunc2;
// <- storage.type.function.intens
//   ^^^^^^ entity.name.function.intens
//         ^ punctuation.separator.intens
//           ^^^^^^^ entity.name.function.intens
//                  ^ punctuation.terminator.intens

FUNC
// <- storage.type.function.intens
    myfunc
//  ^^^^^^ entity.name.function.intens
  , myfunc2
//^ punctuation.separator.intens
//  ^^^^^^^ entity.name.function.intens
  ;
//^ punctuation.terminator.intens

END FUNCTIONS;
//           ^ punctuation.terminator.intens

STREAMER

simple_stream (!foo, foo);

my_stream { XML {SCHEMA="myschema.xsd", VERSION="1.0"} }
//                     ^ keyword.operator.assignment.augmented.intens
  (foo, bar, EOLN);

datapool_stream {XML} (DATAPOOL);

END STREAMER;
//          ^ punctuation.terminator.intens

OPERATOR

SOCKET my_socket {
//               ^ punctuation.section.group.begin.intens
      PORT=666,
//    ^^^^ variable.parameter.intens
//        ^ keyword.operator.assignment.augmented.intens
//         ^^^ constant.numeric.intens
//            ^ punctuation.separator.intens
      STREAM=my_stream,
      FUNC=myfunc},
//         ^^^^^^ variable.function.intens
//               ^ punctuation.section.group.end.intens
//                ^ punctuation.separator.intens
  my_socket2 {
//           ^ punctuation.section.group.begin.intens
      MFM,
      PORT=333,
      STREAM=my_stream2,
      FUNC=myfunc2,
//         ^^^^^^^ variable.function.intens
      ON_EOS=myfunc2,
//           ^^^^^^^ variable.function.intens
      ON_VIEW_ACTION=myfunc2,
//                   ^^^^^^^ variable.function.intens
      struct[*].data,
      THUMBNAIL(struct[*].thumbnail, 200, 200)},
//    ^^^^^^^^^ support.function.builtin.intens
//              ^^^^^^ variable.other.intens
//                                            ^ punctuation.section.group.end.intens
//                                             ^ punctuation.separator.intens
  my_socket3 {
    PORT=666,
    (
      HEADER="MYHEADER",
//                     ^ punctuation.separator.intens
      REQUEST=my_stream,
      FUNC=myfunc,
//    ^^^^ variable.parameter.intens
//        ^ keyword.operator.assignment.augmented.intens
//         ^^^^^^ variable.function.intens
      RESPONSE=simple_stream
    )
  };

PROCESS myprocess_pr: BATCH { "myprocess.pl" };

PROCESSGROUP myprocessgroup_pg {
                "My name",
                FORM=NONE,
                HIDDEN,
                NO_LOG}
    ([foo.bar, EOLN, foo.bar2]
     = myprocess_pr
//   ^ keyword.operator.assignment.augmented.intens
     (foo.bar, EOLN, foo.bar2));

TIMER my_timer {FUNC=myfunc};
//                   ^^^^^^ variable.function.intens

FILESTREAM myfilestream_fs = my_stream {"My Stream",
//                         ^ keyword.operator.assignment.augmented.intens
                                        FILTER="CSV (*.csv)",
                                        WRITEONLY};

MESSAGE_QUEUE
  reply_mq {
    REPLY,
    PORT_REQUEST=334,
    ( HEADER="myheader1",
      FUNC=myfunc,
      RESPONSE(simple_stream, my_stream),
      REQUEST(datapool_stream)
    ),
    ( HEADER="myheader2",
      FUNC=myfunc,
      RESPONSE(simple_stream, my_stream),
      REQUEST(datapool_stream)
    )
  };

END OPERATOR;
//          ^ punctuation.terminator.intens

FUNCTIONS

FUNC myfunc {
// <- storage.type.function.intens
//   ^^^^^^ entity.name.function.intens
//          ^ punctuation.section.block.begin.intens
    INTEGER foo, bar;
//  ^^^^^^^ storage.type.intens
//          ^^^ punctuation.definition.variable.intens
//             ^ punctuation.separator.intens
//               ^^^ punctuation.definition.variable.intens
//                  ^ punctuation.terminator.intens

    RUN ( myfunc2 );
//      ^ punctuation.section.group.begin.intens
//        ^^^^^^^ variable.function.intens
//                ^ punctuation.section.group.end.intens
//                 ^ punctuation.terminator.intens

    SEND(HOST="localhost",
//           ^ keyword.operator.assignment.augmented.intens
         PORT=666,
         STREAM=my_stream);

    folder = DIRNAME{DIRNAME=folder};
//                   ^^^^^^^ variable.parameter.intens
    DIRNAME(myfilestream_fs);

    foo = 0;
    WHILE(foo < (1 + 4)) {
//  ^^^^^ keyword.control.intens
//       ^ punctuation.section.group.begin.intens
//                     ^ punctuation.section.group.end.intens
        RUN( myfunc3 );
//         ^ punctuation.section.group.begin.intens
//           ^^^^^^^ variable.function.intens
//                   ^ punctuation.section.group.end.intens
//                    ^ punctuation.terminator.intens
        IF (foo != 3 && (VALID(foo))) {
//                       ^^^^^ support.function.builtin.intens
            INPUT = OLDVALUE;
            THIS.buzz = 2;
        }
        ELSE {
            bar = ABS(bar - ROUND(1 + 4.8));
//                ^^^ support.function.builtin.intens
//                          ^^^^^ support.function.builtin.intens
            bar += 1.;
//                 ^^ constant.numeric.intens
            RETURN;
//          ^^^^^^ keyword.control.intens
//                ^ punctuation.terminator.intens
        }
        foo++;
    }

    REQUEST(REQUEST=my_stream2, RESPONSE(my_stream, my_stream2), FUNC=myfunc2);
//                                                               ^^^^ variable.parameter.intens
//                                                                   ^ keyword.operator.assignment.augmented.intens
//                                                                    ^^^^^^^ variable.function.intens

    IF (! RUN(myfunc3) ){
        ABORT;
//      ^^^^^ keyword.control.intens
//           ^ punctuation.terminator.intens
    }

    IF ( REASON_OPEN ) {
//  ^^ keyword.control.intens
//     ^ punctuation.section.group.begin.intens
//                   ^ punctuation.section.group.end.intens
//                     ^ punctuation.section.block.begin.intens
        ABORT("Abort message");
//      ^^^^^ support.function.builtin.intens
//                            ^ punctuation.terminator.intens
    }
//  ^ punctuation.section.block.end.intens
    ELSE IF ( REASON_CLOSE ) {
//  ^^^^ keyword.control.intens
//                           ^ punctuation.section.block.begin.intens
    }
//  ^ punctuation.section.block.end.intens
    MESSAGEBOX(COMPOSE("Finished %1!", "function"));
//                               ^^ constant.other.placeholder.intens
}
// <-  punctuation.section.block.end.intens
;
// <- punctuation.terminator.intens

FUNC myfunc2 {},
// <- storage.type.function.intens
//   ^^^^^^^ entity.name.function.intens
//           ^ punctuation.section.block.begin.intens
//            ^ punctuation.section.block.end.intens
//             ^ punctuation.separator.intens
    myfunc3
//  ^^^^^^^ entity.name.function.intens
    {};
//  ^ punctuation.section.block.begin.intens
//   ^ punctuation.section.block.end.intens
//    ^ punctuation.terminator.intens

FUNC{DEADLY_SILENT, UPDATE_FORMS=NONE}
// <- storage.type.function.intens
//  ^ punctuation.section.group.begin.intens
//   ^^^^^^^^^^^^^ variable.parameter.intens
//                ^ punctuation.separator.intens
//                  ^^^^^^^^^^^^ variable.parameter.intens
//                              ^ keyword.operator.assignment.augmented.intens
//                               ^^^^ constant.language.intens
//                                   ^ punctuation.section.group.end.intens
    myfunc4 {};
//  ^^^^^^^ entity.name.function.intens

END FUNCTIONS;
//           ^ punctuation.terminator.intens

UI_MANAGER

FIELDGROUP
// <- storage.type.other.intens
  mygroup_fg { MARGIN(0) } (
//             ^^^^^^ support.function.builtin.intens
    foo.foo
  )
;

FORM
  myform1 { "fancy name 1",
            HIDDEN,
            FUNC=myfunc4 }
    ( ),
  myform2 { "fancy name 1",
            CLOSE_BUTTON=NONE,
            HIDE_CYCLE }
    ( );

IMAGE img1 {
        SIZE(256,256),
        SOCKET=my_socket
        SETTINGS=foo.bar};

INDEX my_index;

FOLDER
  my_folder { LEFT, VERTICAL, STRETCH } ();

TABLE my_table {HORIZONTAL(TABLESIZE=7, RANGE(1)),
//              ^^^^^^^^^^ support.function.builtin.intens
//                         ^^^^^^^^^ variable.parameter.intens
//                                      ^^^^^ support.function.builtin.intens
                VERTICAL(TABLESIZE=7, RANGE(1))}
        (LEFT();
         TOP();
         TABLE(););

END UI_MANAGER;
//            ^ punctuation.terminator.intens

LANGUAGE
END LANGUAGE;

END.
// <- keyword.other.intens
// ^ punctuation.terminator.intens
